# Оптимальный Метод Размещения Датчиков

## 2.3.2 Тензорное QR-разложение

### Введение

Брантон и соавторы [36] показали, что метод матричного QR-разложения с выбором столбцов (column-pivoting) является полезным инструментом для оптимального разреженного размещения датчиков. Однако в данной работе операции проводятся на уровне высокопорядковых тензоров, что делает классическое QR-разложение недостаточным для решения задачи оптимального разреженного размещения датчиков.

В ответ на эту проблему мы предлагаем метод тензорного QR-разложения, основанный на **преобразовании Хаусхолдера с выбором трубок** (tube-pivot Householder transformation) [47]. Основная идея заключается в повторном применении отражателей Хаусхолдера для треугольной факторизации трубок заданного тензора.

### Отражатель Хаусхолдера

Прежде чем перейти к тензорному QR-разложению, рассмотрим **отражатель Хаусхолдера** для вектора.

- Для заданного вектора \( \mathbf{v} \in \mathbb{R}^M \), отражатель Хаусхолдера \( \mathbf{H}(\mathbf{v}) \) может отобразить \( \mathbf{v} \) в \( \| \mathbf{v} \|_2 \mathbf{e}_1 \), где \( \mathbf{e}_1 \) — первый вектор стандартного базиса в \( \mathbb{R}^M \).

**Определение отражателя Хаусхолдера**:

\[
\mathbf{H}(\mathbf{v}) = \mathbf{I} - \frac{(\mathbf{v} + \operatorname{sign}(v_1) \sigma \mathbf{e}_1)(\mathbf{v} + \operatorname{sign}(v_1) \sigma \mathbf{e}_1)^\top}{\sigma (\sigma + |v_1|)} \tag{19}
\]

- \( \mathbf{I} \) — единичная матрица.
- \( \sigma = \| \mathbf{v} \|_2 \) — норма вектора \( \mathbf{v} \).
- \( v_1 \) — первая компонента вектора \( \mathbf{v} \).
- \( \operatorname{sign}(v_1) \) — знак первой компоненты вектора \( \mathbf{v} \).

Уравнение (19) можно переписать в более компактной форме:

\[
\mathbf{H}(\mathbf{v}) = \mathbf{I} - 2 \mathbf{u} \mathbf{u}^\top \tag{20}
\]

где:

\[
\mathbf{u} = \frac{\mathbf{v} + \operatorname{sign}(v_1) \sigma \mathbf{e}_1}{\sqrt{2 \sigma (\sigma + |v_1|)}} \in \mathbb{R}^M
\]

**Свойства отражателя Хаусхолдера**:

- \( \mathbf{H}(\mathbf{v}) \mathbf{H}(\mathbf{v})^\top = \mathbf{I} \), что означает, что \( \mathbf{H}(\mathbf{v}) \) является ортогональной матрицей.
- \( \mathbf{H}(\mathbf{v}) = \mathbf{H}(\mathbf{v})^\top = \mathbf{H}(\mathbf{v})^{-1} \).

### Тензорное QR-разложение

#### Формулировка

**Тензорное QR-разложение с выбором трубок** на \( d \)-й итерации задается следующим образом:

\[
\mathcal{X} \approx \mathcal{X} \times_3 \mathbf{P}_d = \mathbf{Q}_d \times_3 \mathcal{R}_d \tag{21}
\]

- \( \mathcal{X} \) — исходный тензор.
- \( \mathbf{Q}_d \) — ортогональная матрица размера \( K \times K \).
- \( \mathbf{P}_d \) — матрица перестановок размера \( I \times J \).
- \( \mathcal{R}_d \) — тензор треугольной формы с выбором трубок (tube-pivot triangular tensor).
- Операция \( \times_3 \) обозначает произведение тензора на матрицу по третьему измерению.

**Примечания**:

- Элементы матрицы \( \mathbf{P}_d \) являются бинарными (0 или 1).
- Норма \( \| \mathbf{P}_d \|_1 = d \) ограничена сверху числом \( N \leq K \), которое обычно определяется энергетическими методами.
- Когда \( N = K \), мы получаем полное QR-разложение: \( \mathcal{X} = \mathcal{X} \times_3 \mathbf{P}_d \).

#### Процесс QR-разложения с выбором трубок

Процесс итеративного QR-разложения с выбором трубок представлен на **Рисунке 2** (предполагается, что рисунок иллюстрирует процесс).

**Представление тензора \(\mathcal{X}\) через трубки**:

Тензор \( \mathcal{X} \) можно представить как набор трубок (tube fibers):

\[
\mathcal{X} = \begin{bmatrix}
\mathcal{X}_{11:} & \dots & \mathcal{X}_{1j:} \\
\vdots & \ddots & \vdots \\
\mathcal{X}_{i1:} & \dots & \mathcal{X}_{ij:}
\end{bmatrix} \tag{22}
\]

- Каждая трубка \( \mathcal{X}_{ij:} \) — это вектор, полученный фиксированием индексов \( i \) и \( j \) и варьированием третьего измерения.

#### Инициализация

- **Начальные значения**:

  - \( \mathbf{P}_0 = \mathbf{0} \) — нулевая матрица.
  - \( \mathbf{Q}_0 = \mathbf{I} \) — единичная матрица.
  - \( \mathcal{R}_0 = \mathcal{X} \).

- **Вычисление трубочно-нормы \( \ell_1 \) тензора \( \mathcal{R} \)**:

\[
\| \mathcal{R} \|_{\text{tube-wise}} = \begin{bmatrix}
\| \mathcal{R}_{11:} \|_1 & \dots & \| \mathcal{R}_{1j:} \|_1 \\
\vdots & \ddots & \vdots \\
\| \mathcal{R}_{i1:} \|_1 & \dots & \| \mathcal{R}_{ij:} \|_1
\end{bmatrix} \tag{23}
\]

- Здесь \( \| \mathcal{R}_{ij:} \|_1 \) — сумма абсолютных значений элементов трубки \( \mathcal{R}_{ij:} \).

#### Выбор матрицы перестановок \( \mathbf{P}_d \)

- Матрица \( \mathbf{P}_d \) определяется по \( \ell_\infty \)-норме трубочной нормы \( \| \mathcal{R} \|_{\text{tube-wise}} \).
- На \( d \)-й итерации позиция индекса, соответствующая максимальному значению \( \ell_\infty \)-нормы, устанавливается в 1 в матрице \( \mathbf{P}_{d-1} \).
- Соответствующая трубка \( \mathcal{X}_{ij:} \) содержит \( K - d + 1 \) элементов и обозначается как \( \mathbf{t}_{d-1} \).

#### Обновление с помощью отражателей Хаусхолдера

- Трубки тензора \( \mathcal{X} \) являются векторами, поэтому мы используем отражатели Хаусхолдера для треугольной факторизации.
- На \( d \)-й итерации матрица \( \mathbf{Q}_d \) обновляется по формуле:

\[
\mathbf{Q}_d = \mathbf{Q}_{d-1} \begin{pmatrix}
\mathbf{I} & \mathbf{0} \\
\mathbf{0} & \mathbf{H}(\mathbf{t}_{d-1})
\end{pmatrix} \tag{24}
\]

- Здесь \( \mathbf{H}(\mathbf{t}_{d-1}) \) — отражатель Хаусхолдера, применяемый к трубке \( \mathbf{t}_{d-1} \).

#### Обобщенный алгоритм

Полная процедура тензорного QR-разложения представлена в **Алгоритме 2**.

---

**Алгоритм 2: Тензорное QR-разложение с выбором трубок**

**Вход**: \( \mathcal{X} \), \( N \)

**Выход**: \( \mathbf{P} \), \( \mathbf{Q} \), \( \mathcal{R} \)

1. **Инициализация**:
   - Получаем размеры тензора: \( n_1, n_2, m \leftarrow \text{size}(\mathcal{X}) \).
   - Копируем тензор: \( \mathcal{R} \leftarrow \text{copy}(\mathcal{X}) \).
   - Устанавливаем начальную матрицу: \( \mathbf{Q} \leftarrow \text{eye}(k) \).
   - Инициализируем матрицы: \( \mathbf{P}, \mathbf{M} \leftarrow \text{zeros}(n_1, n_2) \).

2. **Основной цикл**: для \( d = 1 \) до \( N \) выполняем:
   - **Вычисляем трубочно-норму \( \ell_1 \)** для всех трубок:
     - Для \( i = 1 \) до \( n_1 \):
       - Для \( j = 1 \) до \( n_2 \):
         - \( \mathbf{M}[i, j] \leftarrow \| \mathcal{R}_{ij:} \|_1 \).
   - **Выбор максимума**:
     - Находим индексы \( x, y \) позиции максимального элемента в \( \mathbf{M} \) (т.е., максимальную трубочную норму).
     - Проверяем, что позиция индекса \( (x, y) \) принадлежит допустимой области \( \mathfrak{A} \).
   - **Обновление матрицы перестановок**:
     - Устанавливаем \( \mathbf{P}[x, y] = 1 \).
   - **Извлечение трубки**:
     - \( \mathbf{t} \leftarrow \) последние \( (d-1) \) элементов трубки \( \mathcal{X}_{x y :} \).
   - **Вычисление отражателя Хаусхолдера**:
     - \( \sigma \leftarrow \| \mathbf{t} \|_2 \).
     - \( \mathbf{u} \leftarrow \frac{\mathbf{t} + \operatorname{sign}(t_1) \sigma \mathbf{e}_d}{\sqrt{2 \sigma (\sigma + |t_1|)}} \).
   - **Обновление тензора \( \mathcal{R} \)**:
     - \( \mathcal{R}_{x y d:k} \leftarrow \mathcal{R}_{x y d:k} - 2 \mathbf{u} \mathbf{u}^\top \mathcal{R}_{x y d:k} \).
   - **Обновление матрицы \( \mathbf{Q} \)**:
     - \( \mathbf{Q}_{: d:k} \leftarrow \mathbf{Q}_{: d:k} - 2 \mathbf{Q}_{: d:k} \mathbf{u} \mathbf{u}^\top \).
3. **Возврат результатов**:
   - \( \mathbf{P}, \mathbf{Q}, \mathcal{R} \).

**Примечание**: \( \mathfrak{A} \) обозначает дополнение области отбраковки (rejection domain), которая определяется сложными ограничениями в реальной физической системе.

---

### Подробное Объяснение

#### Пошаговый разбор алгоритма

1. **Инициализация**:

   - **Размеры тензора**: Определяем размеры входного тензора \( \mathcal{X} \): \( n_1 \), \( n_2 \), \( m \).
   - **Копирование тензора**: Создаем копию тензора \( \mathcal{R} \) для работы в алгоритме.
   - **Матрица \( \mathbf{Q} \)**: Инициализируем ортогональную матрицу \( \mathbf{Q} \) как единичную матрицу размера \( k \times k \).
   - **Матрицы \( \mathbf{P} \) и \( \mathbf{M} \)**: Инициализируем нулевые матрицы размером \( n_1 \times n_2 \).

2. **Основной цикл**:

   - Для каждой итерации \( d \) от 1 до \( N \) выполняем следующие шаги:

     a. **Вычисление трубочных норм**:

        - Проходим по всем трубкам \( \mathcal{R}_{ij:} \) тензора \( \mathcal{R} \).
        - Вычисляем \( \ell_1 \)-норму каждой трубки и сохраняем значения в матрице \( \mathbf{M} \).

     b. **Выбор трубки для обработки**:

        - Находим индексы \( x, y \) максимального элемента в матрице \( \mathbf{M} \), что соответствует трубке с наибольшей нормой.
        - Проверяем, что выбранная трубка не принадлежит области отбраковки \( \mathfrak{A} \).

     c. **Обновление матрицы перестановок \( \mathbf{P} \)**:

        - Устанавливаем элемент \( \mathbf{P}[x, y] = 1 \), что означает выбор соответствующей трубки для обработки.

     d. **Извлечение трубки**:

        - Извлекаем последние \( k - d + 1 \) элементов трубки \( \mathcal{X}_{xy:} \), обозначая их как \( \mathbf{t} \).

     e. **Построение отражателя Хаусхолдера**:

        - Вычисляем норму \( \sigma = \| \mathbf{t} \|_2 \).
        - Вычисляем вектор \( \mathbf{u} \) по формуле:

          \[
          \mathbf{u} = \frac{\mathbf{t} + \operatorname{sign}(t_1) \sigma \mathbf{e}_d}{\sqrt{2 \sigma (\sigma + |t_1|)}}
          \]

     f. **Обновление тензора \( \mathcal{R} \)**:

        - Применяем отражатель Хаусхолдера для обновления соответствующей части тензора \( \mathcal{R} \):

          \[
          \mathcal{R}_{x y d:k} \leftarrow \mathcal{R}_{x y d:k} - 2 \mathbf{u} (\mathbf{u}^\top \mathcal{R}_{x y d:k})
          \]

     g. **Обновление матрицы \( \mathbf{Q} \)**:

        - Обновляем матрицу \( \mathbf{Q} \) аналогичным образом:

          \[
          \mathbf{Q}_{: d:k} \leftarrow \mathbf{Q}_{: d:k} - 2 \mathbf{Q}_{: d:k} \mathbf{u} \mathbf{u}^\top
          \]

3. **Возврат результатов**:

   - После выполнения всех итераций возвращаем матрицу перестановок \( \mathbf{P} \), ортогональную матрицу \( \mathbf{Q} \) и треугольный тензор \( \mathcal{R} \).

#### Объяснение ключевых шагов и понятий

##### Трубки (Tube Fibers)

- **Трубка** в тензоре — это вектор, полученный фиксированием двух индексов и варьированием третьего.
- В нашем случае трубки \( \mathcal{X}_{ij:} \) являются основными элементами для обработки в алгоритме.

##### Трубочно-норма \( \ell_1 \)

- **Трубочно-норма \( \ell_1 \)** трубки \( \mathcal{R}_{ij:} \) вычисляется как сумма абсолютных значений ее элементов.
- Эта норма используется для определения "важности" трубки: чем больше норма, тем более значимая трубка для дальнейшей обработки.

##### Выбор трубок с максимальной нормой

- На каждой итерации выбирается трубка с наибольшей трубочно-нормой \( \ell_1 \).
- Это позволяет последовательно обрабатывать наиболее значимые части тензора для эффективного разложения.

##### Применение отражателя Хаусхолдера

- Отражатель Хаусхолдера используется для "обнуления" элементов трубки ниже главной диагонали, превращая ее в треугольную форму.
- Это аналогично процессу в классическом QR-разложении для матриц, но расширено на тензоры.

##### Обновление тензора \( \mathcal{R} \) и матрицы \( \mathbf{Q} \)

- После применения отражателя Хаусхолдера соответствующие части тензора \( \mathcal{R} \) и матрицы \( \mathbf{Q} \) обновляются.
- Это гарантирует, что на следующих итерациях будут учитываться изменения, внесенные на текущей итерации.

##### Матрица перестановок \( \mathbf{P} \)

- Матрица \( \mathbf{P} \) накапливает информацию о том, какие трубки были выбраны и обработаны на каждой итерации.
- В конечном итоге она определяет оптимальное расположение датчиков в соответствии с алгоритмом.

#### Связь с задачей оптимального размещения датчиков

- Тензорное QR-разложение с выбором трубок используется для решения задачи оптимального размещения датчиков.
- Выбор трубок с максимальной нормой соответствует выбору наиболее информативных позиций для размещения датчиков.
- Матрица перестановок \( \mathbf{P} \) указывает на оптимальные позиции датчиков, обеспечивая наилучшее восстановление поля при разреженных измерениях.

### Заключение

Тензорное QR-разложение с выбором трубок расширяет возможности классического QR-разложения для работы с высокопорядковыми тензорами. Это особенно полезно в задачах оптимального размещения датчиков в высокоразмерных системах, где необходимо эффективно выбирать позиции для датчиков, обеспечивая при этом точное восстановление системы.

- **Преимущества метода**:

  - Позволяет работать с тензорами высокого порядка.
  - Учитывает структуру данных при выборе позиций для датчиков.
  - Обеспечивает эффективное разложение и восстановление данных.

- **Практическое значение**:

  - Метод может быть применен в областях, где данные имеют тензорную структуру, например, в обработке изображений, видео, многомерных сигналов.
  - Способствует эффективному использованию ограниченных ресурсов при сборе данных и мониторинге сложных систем.

---

**Ссылки**:

[36] Brunton, S. L., Kutz, J. N. «Optimal sensor placement and enhanced sparsity for classification», 2016.

[47] Zhang, X., Sun, Y., Liu, Q. «A Householder QR Decomposition Algorithm for Tensors via Tensor-Vector Product», 2018.

---

### Подробное Объяснение Концепций

#### Отражатель Хаусхолдера

**Отражатель Хаусхолдера** — это ортогональная матрица, которая используется для отражения вектора относительно гиперплоскости. В линейной алгебре отражатели Хаусхолдера широко применяются для ортогонализации векторов, особенно в процессе QR-разложения матриц.

**Математическое Определение**:

Для данного ненулевого вектора \( \mathbf{v} \in \mathbb{R}^n \) отражатель Хаусхолдера \( \mathbf{H} \) определяется как:

\[
\mathbf{H} = \mathbf{I} - 2 \mathbf{u} \mathbf{u}^\top
\]

где:

- \( \mathbf{u} = \frac{\mathbf{v} + \alpha \mathbf{e}_1}{\| \mathbf{v} + \alpha \mathbf{e}_1 \|_2} \)
- \( \alpha = \operatorname{sign}(v_1) \| \mathbf{v} \|_2 \)
- \( \mathbf{e}_1 \) — первый вектор стандартного базиса в \( \mathbb{R}^n \)

**Свойства Отражателя Хаусхолдера**:

- **Ортогональность**: \( \mathbf{H}^\top = \mathbf{H}^{-1} \)
- **Симметричность**: \( \mathbf{H} = \mathbf{H}^\top \)
- **Применение**: Преобразует вектор \( \mathbf{v} \) в \( \beta \mathbf{e}_1 \), где \( \beta = \| \mathbf{v} \|_2 \)

#### Трубки в Тензорах

**Трубка** (tube fiber) в тензоре — это одномерный срез тензора, полученный фиксацией всех индексов, кроме одного.

- **Виды трубок в трёхмерном тензоре**:
  - **Столбцовые трубки**: \( \mathcal{X}_{ij:} \)
  - **Строчные трубки**: \( \mathcal{X}_{i:k} \)
  - **Глубинные трубки**: \( \mathcal{X}_{:jk} \)

#### Трубочная Норма

**Трубочная норма** — это норма, вычисляемая для трубки тензора.

- **\( \ell_1 \)-норма трубки** \( \mathcal{X}_{ij:} \):

\[
\| \mathcal{X}_{ij:} \|_1 = \sum_{k=1}^{K} | \mathcal{X}_{ijk} |
\]

- **Применение**: Используется для оценки "важности" трубки при выборе позиций для датчиков.

#### Связь Между Концепциями

- **Трубки рассматриваются как векторы**, к которым можно применять отражатели Хаусхолдера для ортогонализации.
- **Трубочная норма** помогает определить, какие трубки наиболее информативны для обработки.
- **Тензорное QR-разложение** расширяет классическое QR-разложение на многомерные данные, работая с трубками вместо столбцов.

### Заключение

Понимание перечисленных выше понятий и методов является ключевым для глубокого понимания подхода к оптимальному размещению датчиков и восстановления полей в высокоразмерных динамических системах. Эти математические инструменты позволяют эффективно решать задачи, связанные с ограниченностью измерительных ресурсов и необходимостью точного восстановления систем на основе разреженных данных.

- **Отражатель Хаусхолдера**: Мощный инструмент для ортогонализации векторов, расширенный для применения к тензорам.
- **Трубочная норма**: Критерий для оценки "важности" трубок в тензоре, позволяющий выбирать наиболее информативные для обработки.
- **Трубки**: Основные элементы в тензоре для проведения QR-разложения в многомерном пространстве.

Использование этих методов и понимание их теоретических основ позволяет разрабатывать эффективные алгоритмы и решения для практических приложений в различных областях науки и техники.

---

**Ссылки**:

[36] Brunton, S. L., Kutz, J. N. «Optimal sensor placement and enhanced sparsity for classification», 2016.

[47] Zhang, X., Sun, Y., Liu, Q. «A Householder QR Decomposition Algorithm for Tensors via Tensor-Vector Product», 2018.

---