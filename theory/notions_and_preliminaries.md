# Обозначения и Предварительные Сведения

## Введение

В этой главе мы рассмотрим основные обозначения и понятия, которые будут использоваться в дальнейшем. Понимание этих обозначений и операций с тензорами является ключевым для последующего изучения методов тензорного анализа, модального разложения и оптимального размещения датчиков.

## Обозначения

- **Тензоры** обозначаются прописными каллиграфическими буквами: $\mathcal{X}$.
- **Матрицы** обозначаются полужирными прописными буквами: $\mathbf{X}$.
- **Векторы** обозначаются полужирными строчными буквами: $\mathbf{x}$.
- **Скалярные величины** обозначаются строчными буквами: $x$.
- **Поле вещественных чисел** обозначается $\mathbb{R}$.
- **Единичная матрица** обозначается $\mathbf{I}$.
- **Оптимальные оценки** векторов и матриц обозначаются через $\hat{}$: $\hat{\mathbf{x}}, \hat{\mathbf{X}}$.

### Индексация Тензоров

- Для тензора третьего порядка $\mathcal{X} \in \mathbb{R}^{I \times J \times K}$:
  - Его элемент с индексами $(i, j, k)$ обозначается $\mathcal{X}_{ijk}$ или $x_{ijk}$.
  - **Горизонтальные срезы**: $\mathcal{X}_{i::}$ — фиксирован индекс $i$.
  - **Боковые срезы**: $\mathcal{X}_{:i:}$ — фиксирован индекс $j$.
  - **Фронтальные срезы**: $\mathcal{X}_{::i}$ — фиксирован индекс $k$.
- **Фибры** тензора:
  - **Мода-1 (столбцовые) фибры**: $\mathcal{X}_{:jk}$.
  - **Мода-2 (строчные) фибры**: $\mathcal{X}_{i:k}$.
  - **Мода-3 (трубки)**: $\mathcal{X}_{ij:}$.

## Нормы Векторов, Матриц и Тензоров

### $\ell_1$-норма

- Для тензора $\mathcal{X}$:
  $$
  \| \mathcal{X} \|_1 = \sum_{i=1}^{I} \sum_{j=1}^{J} \sum_{k=1}^{K} | \mathcal{X}_{ijk} |
  $$
- **Пример**:
  - Пусть $\mathcal{X}$ — тензор размера $2 \times 2 \times 2$ с элементами:
    $$
    \mathcal{X}_{111} = 1, \quad \mathcal{X}_{112} = -2, \quad \mathcal{X}_{121} = 3, \quad \mathcal{X}_{122} = -4, \quad \text{остальные элементы равны 0}.
    $$
  - Тогда $\| \mathcal{X} \|_1 = |1| + |-2| + |3| + |-4| = 10$.

### $\ell_{\infty}$-норма (Норма бесконечности)

- Для тензора $\mathcal{X}$:
  $$
  \| \mathcal{X} \|_{\infty} = \max_{i,j,k} | \mathcal{X}_{ijk} |
  $$
- **Пример**:
  - Используя предыдущий тензор, $\| \mathcal{X} \|_{\infty} = \max\{ |1|, |-2|, |3|, |-4| \} = 4$.

### $\ell_0$-норма

- Количество ненулевых элементов в тензоре:
  $$
  \| \mathcal{X} \|_0 = \sum_{i=1}^{I} \sum_{j=1}^{J} \sum_{k=1}^{K} \mathbb{I} ( \mathcal{X}_{ijk} \ne 0 )
  $$
- Где $\mathbb{I}(\cdot)$ — индикаторная функция, возвращающая 1, если условие выполняется, и 0 в противном случае.
- **Пример**:
  - В нашем тензоре четыре ненулевых элемента, поэтому $\| \mathcal{X} \|_0 = 4$.

### Норма Фробениуса

- Для тензора $\mathcal{X}$:
  $$
  \| \mathcal{X} \|_F = \sqrt{ \sum_{i,j,k} | \mathcal{X}_{ijk} |^2 }
  $$
- **Пример**:
  - $\| \mathcal{X} \|_F = \sqrt{ 1^2 + (-2)^2 + 3^2 + (-4)^2 } = \sqrt{1 + 4 + 9 + 16} = \sqrt{30} \approx 5.477$.

### $\ell_2$-норма для векторов

- Для вектора $\mathbf{x}$:
  $$
  \| \mathbf{x} \|_2 = \sqrt{ \sum_{i} x_i^2 }
  $$
- **Пример**:
  - Пусть $\mathbf{x} = [1, -2, 3]^\top$, тогда $\| \mathbf{x} \|_2 = \sqrt{1^2 + (-2)^2 + 3^2} = \sqrt{1 + 4 + 9} = \sqrt{14} \approx 3.742$.

## Матрицификация Тензора (Развертка по моде-n)

- **Определение**: Матрицификация тензора $\mathcal{A}$ по моде $n$ обозначается $\mathcal{A}_{(n)}$ и заключается в перестановке элементов тензора так, чтобы фибры по моде $n$ стали столбцами результирующей матрицы.

### Формула (1): Индексация элементов при матрицификации

- Для тензора $\mathcal{A} \in \mathbb{R}^{I_1 \times I_2 \times \dots \times I_N}$, элемент $\mathcal{A}_{i_1 i_2 \dots i_N}$ отображается в элемент $A_{i_n, j}$ матрицы $\mathcal{A}_{(n)} \in \mathbb{R}^{I_n \times (\prod_{m=1, m \ne n}^{N} I_m)}$, где индекс $j$ вычисляется по формуле:

  $$
  j = 1 + \sum_{k=1, k \ne n}^{N} (i_k - 1) \prod_{m=1}^{k-1} I_m, \quad m \ne n
  $$
  
- **Пояснение**:
  - Формула определяет, как элементы тензора перенумеровываются при матрицификации по моде $n$.
  - Это позволяет точно определить позицию каждого элемента тензора в матрице $\mathcal{A}_{(n)}$.

### Пример матрицификации тензора третьего порядка $\mathcal{X} \in \mathbb{R}^{I \times J \times K}$

- **Мода-1 матрицификация** $\mathcal{X}_{(1)}$:
  - Размерность матрицы: $I \times (J \cdot K)$.
  - Столбцы: фибры по моде-1 (столбцовые фибры).
- **Мода-2 матрицификация** $\mathcal{X}_{(2)}$:
  - Размерность матрицы: $J \times (I \cdot K)$.
  - Столбцы: фибры по моде-2 (строчные фибры).
- **Мода-3 матрицификация** $\mathcal{X}_{(3)}$:
  - Размерность матрицы: $K \times (I \cdot J)$.
  - Столбцы: фибры по моде-3 (трубки).

## Развертка Тензоров в Матрицы (Уравнение 2)

- Для тензора $\mathcal{X} \in \mathbb{R}^{I \times J \times K}$ его горизонтальная развертка может быть выражена как:

  $$
  \begin{cases}
  \mathcal{X}_{(1)} = [ \mathcal{X}_{::1}, \dots, \mathcal{X}_{::k} ] \\
  \mathcal{X}_{(2)} = [ \mathcal{X}_{::1}^\top, \dots, \mathcal{X}_{::k}^\top ] \\
  \mathcal{X}_{(3)} = [ \mathcal{X}_{:1:}, \dots, \mathcal{X}_{:j:} ]
  \end{cases} \tag{2}
  $$

- **Объяснение**:
  - $\mathcal{X}_{::k}$ — фронтальный срез тензора при фиксированном $k$.
  - В $\mathcal{X}_{(1)}$ мы объединяем все фронтальные срезы в одну матрицу, располагая их рядом по горизонтали.
  - В $\mathcal{X}_{(2)}$ мы берем транспонированные фронтальные срезы.
  - В $\mathcal{X}_{(3)}$ мы объединяем боковые срезы $\mathcal{X}_{:j:}$.

- **Пример**:
  - Пусть $\mathcal{X}$ имеет размеры $2 \times 2 \times 2$.
  - Фронтальные срезы:
    - $\mathcal{X}_{::1}$ — матрица размера $2 \times 2$ при $k = 1$.
    - $\mathcal{X}_{::2}$ — при $k = 2$.
  - Тогда $\mathcal{X}_{(1)}$ — матрица размера $2 \times 4$, составленная из $\mathcal{X}_{::1}$ и $\mathcal{X}_{::2}$.

## Произведение Тензора на Матрицу по Моде-n (Уравнение 3)

- **Обозначение**: Произведение тензора $\mathcal{A}$ на матрицу $\mathbf{B} \in \mathbb{R}^{J \times I_n}$ по моде $n$ обозначается $\mathcal{A} \times_n \mathbf{B}$.

- **Определение**:

  $$
  (\mathcal{A} \times_n \mathbf{B})_{i_1 \dots i_{n-1} j i_{n+1} \dots i_N} = \sum_{i_n=1}^{I_n} \mathcal{A}_{i_1 i_2 \dots i_N} \mathbf{B}_{j i_n}, \quad \forall i_1, \dots, i_{n-1}, j, i_{n+1}, \dots, i_N \tag{3}
  $$

- **Пояснение**:
  - Произведение осуществляется по индексу $i_n$, заменяя его на $j$.
  - Результатом является тензор, где размерность по моде $n$ изменяется с $I_n$ на $J$.

- **Пример**:
  - Пусть $\mathcal{A} \in \mathbb{R}^{2 \times 3 \times 4}$, $\mathbf{B} \in \mathbb{R}^{5 \times 2}$, $n = 1$.
  - Тогда $\mathcal{A} \times_1 \mathbf{B} \in \mathbb{R}^{5 \times 3 \times 4}$.

## Произведение Тензора Третьего Порядка на Матрицы по Различным Модам (Уравнение 4)

- Для тензора $\mathcal{X} \in \mathbb{R}^{I \times J \times K}$ и матриц $\mathbf{C} \in \mathbb{R}^{N_1 \times I}$, $\mathbf{E} \in \mathbb{R}^{N_2 \times J}$, $\mathbf{F} \in \mathbb{R}^{N_3 \times K}$:

  $$
  \begin{cases}
  (\mathcal{X} \times_1 \mathbf{C})_{n_1 i_2 i_3} = \sum_{i_1=1}^{I} x_{i_1 i_2 i_3} c_{n_1 i_1}, \quad \forall n_1, i_2, i_3 \\
  (\mathcal{X} \times_2 \mathbf{E})_{i_1 n_2 i_3} = \sum_{i_2=1}^{J} x_{i_1 i_2 i_3} e_{n_2 i_2}, \quad \forall i_1, n_2, i_3 \\
  (\mathcal{X} \times_3 \mathbf{F})_{i_1 i_2 n_3} = \sum_{i_3=1}^{K} x_{i_1 i_2 i_3} f_{n_3 i_3}, \quad \forall i_1, i_2, n_3
  \end{cases} \tag{4}
  $$

- **Пояснение**:
  - Каждое произведение изменяет размерность тензора по соответствующей моде.
  - Например, после $\times_1 \mathbf{C}$ размерность по первой моде становится $N_1$.

- **Пример**:
  - Пусть $\mathcal{X} \in \mathbb{R}^{2 \times 3 \times 4}$, $\mathbf{C} \in \mathbb{R}^{5 \times 2}$.
  - Тогда $\mathcal{X} \times_1 \mathbf{C} \in \mathbb{R}^{5 \times 3 \times 4}$.

## Временные Срезы Системы и Представление Тензора

- Для системы, меняющейся во времени, ее срез в момент времени $t$ выражается матрицей $\mathbf{X}_t$, где $\mathbf{X}_t \in \mathbb{R}^{I \times J}$.

- Система за интервал времени от $t_0$ до $t_1$ с $k$ временными срезами при шаге $\Delta t$ представляется тензором третьего порядка:

  $$
  \mathcal{X} = \{ \mathbf{X}_{t_0}, \mathbf{X}_{t_0 + \Delta t}, \dots, \mathbf{X}_{t_1} \}
  $$

- $t_1 = t_0 + (k - 1) \Delta t$.

## Произведения по Третьему Измерению (Уравнения 5 и 6)

### Произведение по Моде-3 на Матрицу (Уравнение 5)

- **Обозначение**: Мода-3 произведение по фибрам тензора $\mathcal{X}$ и матрицы $\mathbf{B} \in \mathbb{R}^{K \times K}$ обозначается $\mathbf{B} \times_3 \mathcal{X}$.

- **Определение**:

  $$
  (\mathbf{B} \times_3 \mathcal{X})_{i_1 i_2 :} = \mathbf{B} \times \mathcal{X}_{i_1 i_2 :}, \quad \forall i_1, i_2 \tag{5}
  $$

- **Пояснение**:
  - Для каждого элемента $(i_1, i_2)$ тензора мы умножаем соответствующую трубку $\mathcal{X}_{i_1 i_2 :}$ (вектор длины $K$) на матрицу $\mathbf{B}$.

### Произведение по Моде-3 на Вектор (Уравнение 6)

- **Обозначение**: Фронтальное произведение тензора $\mathcal{X}$ на вектор $\mathbf{v} \in \mathbb{R}^{K}$ обозначается $\mathcal{X} \times_{(3)} \mathbf{v}$.

- **Определение**:

  $$
  \mathcal{X} \times_{(3)} \mathbf{v} = \sum_{k=1}^{K} \mathcal{X}_{::k} \cdot v_k \tag{6}
  $$

- **Пояснение**:
  - Это свертка тензора по третьему измерению с весами, заданными вектором $\mathbf{v}$.
  - Результатом является матрица размера $I \times J$.

- **Пример**:
  - Пусть $\mathcal{X} \in \mathbb{R}^{2 \times 2 \times 3}$, $\mathbf{v} = [v_1, v_2, v_3]^\top$.
  - Тогда:
    $$
    \mathcal{X} \times_{(3)} \mathbf{v} = \mathcal{X}_{::1} v_1 + \mathcal{X}_{::2} v_2 + \mathcal{X}_{::3} v_3
    $$

## Транспонирование Тензора по Фронтальным Срезам (Уравнение 7)

- **Определение**:

  $$
  (\mathcal{X}^\top)_{::k} = \mathcal{X}_{::(K + 1 - k)} \tag{7}
  $$

- **Пояснение**:
  - Это означает, что фронтальные срезы тензора $\mathcal{X}$ располагаются в обратном порядке в $\mathcal{X}^\top$.

- **Пример**:
  - Если $K = 3$, то:
    - $(\mathcal{X}^\top)_{::1} = \mathcal{X}_{::3}$
    - $(\mathcal{X}^\top)_{::2} = \mathcal{X}_{::2}$
    - $(\mathcal{X}^\top)_{::3} = \mathcal{X}_{::1}$

## Точечное Произведение Тензоров по Трубкам (Уравнение 8)

- **Определение**:

  $$
  (\mathcal{X}^\top \times_{\text{dot}} \mathcal{X})_{ij} = \sum_{k=1}^{K} ( \mathcal{X}_{::i} \cdot \mathcal{X}_{::j} )_k \tag{8}
  $$

- **Пояснение**:
  - Операция $\times_{\text{dot}}$ означает точечное произведение по соответствующим трубкам.
  - Мы берем скалярное произведение трубок $\mathcal{X}_{::i}$ и $\mathcal{X}_{::j}$ и суммируем по $k$.

- **Пример**:
  - Для тензора $\mathcal{X} \in \mathbb{R}^{I \times J \times K}$:
    - Для индексов $i$ и $j$, элемент $(\mathcal{X}^\top \times_{\text{dot}} \mathcal{X})_{ij}$ вычисляется как сумма произведений соответствующих элементов трубок $\mathcal{X}_{::i}$ и $\mathcal{X}_{::j}$.

## Заключение

В данной главе мы рассмотрели основные обозначения и операции с тензорами, которые необходимы для понимания методов тензорного анализа и модального разложения. Мы разобрали понятия матрицификации тензора, произведения тензора на матрицу и вектор по различным модам, а также специальные операции, такие как транспонирование по фронтальным срезам и точечное произведение по трубкам.

Понимание этих операций позволяет эффективно работать с тензорами в задачах обработки многомерных данных, оптимального размещения датчиков и восстановления полей в динамических системах.

## Рекомендации для Семинара

- **Объясняйте понятия постепенно**: Начните с основных определений тензоров, матриц и векторов.
- **Используйте визуализации**: При возможности, показывайте тензоры как многомерные массивы, иллюстрируйте срезы и фибры.
- **Приводите простые числовые примеры**: Это поможет слушателям лучше понять, как работают операции.
- **Связывайте теорию с практикой**: Объясните, как эти операции применяются в контексте задачи оптимального размещения датчиков.
- **Поощряйте вопросы**: Будьте готовы ответить на вопросы и уточнить сложные моменты.

## Дополнительные Материалы

- **Тензорное исчисление**: Рекомендуется ознакомиться с основами тензорного исчисления и его применениями в различных областях.
- **Литература**:
  - Kolda, T. G., & Bader, B. W. (2009). Tensor Decompositions and Applications. SIAM Review, 51(3), 455–500.
