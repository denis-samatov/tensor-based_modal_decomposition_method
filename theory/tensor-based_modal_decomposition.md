# Тензорное Модальное Разложение

## Введение

Тензорное модальное разложение является мощным инструментом для анализа многомерных данных. Оно позволяет представить исходный тензор данных в виде ядра и набора матриц мод, что упрощает понимание и обработку сложных систем.

## Модель Такера

### Формулировка

Модель Такера представляет тензор $\mathcal{X}$ как произведение ядра $\mathcal{G}$ и матриц мод:

$$
\mathcal{X} = \mathcal{G} \times_1 A \times_2 B \times_3 C + \mathcal{E}
$$

где:

- $\mathcal{X} \in \mathbb{R}^{I \times J \times K}$ — исходный тензор.
- $A \in \mathbb{R}^{I \times P}$, $B \in \mathbb{R}^{J \times Q}$, $C \in \mathbb{R}^{K \times R}$ — матрицы мод, соответствующие каждому измерению тензора.
- $\mathcal{G} \in \mathbb{R}^{P \times Q \times R}$ — ядро тензора, отражающее взаимодействие между различными модами.
- $\mathcal{E} \in \mathbb{R}^{I \times J \times K}$ — остаток разложения.

### Элементная форма

Уравнение можно представить в элементном виде:

$$
\mathcal{X}_{ijk} = \sum_{p=1}^{P} \sum_{q=1}^{Q} \sum_{r=1}^{R} \mathcal{G}_{pqr} A_{ip} B_{jq} C_{kr} + \mathcal{E}_{ijk}
$$

где $i = 1, \dots, I$, $j = 1, \dots, J$, $k = 1, \dots, K$.

Это уравнение показывает, как каждый элемент исходного тензора выражается через сумму произведений элементов ядра и соответствующих матриц мод.

## Задача оптимизации

Цель состоит в том, чтобы найти такие матрицы мод $A$, $B$, $C$ и ядро $\mathcal{G}$, которые минимизируют разницу между исходным тензором $\mathcal{X}$ и его приближением $\hat{\mathcal{X}}$:

$$
\min_{A,B,C,\mathcal{G}} \left\| \mathcal{X} - \hat{\mathcal{X}}(A, B, C, \mathcal{G}) \right\|_F
$$

где $\left\| \cdot \right\|_F$ обозначает фробениусову норму тензора.

## Метод Высшего Порядка Сингулярного Разложения (HOSVD)

Для решения задачи оптимизации используется метод HOSVD. Этот метод расширяет концепцию сингулярного разложения матриц на тензоры высшего порядка.

![Описание изображения](images/hosvd.png)
*Рисунок 1 - Пример работы HOSVD.*


### Алгоритм HOSVD

Алгоритм 1 описывает процедуру HOSVD для тензора третьего порядка.

**Алгоритм 1: HOSVD для тензора третьего порядка**

**Вход**:

- $\mathcal{X}$ — исходный тензор.
- $\epsilon$ — заданный порог сходимости.

**Выход**:

- $\hat{\mathcal{G}}$ — ядро тензора.
- $\hat{A}$, $\hat{B}$, $\hat{C}$ — матрицы мод.

**Инициализация**:

1. $k \leftarrow 0$
2. $\mathcal{G}^{(0)} \leftarrow 0$
3. $R_n^{(0)} \leftarrow \min(I, J, K)$ для каждого измерения $n$
4. $r \leftarrow \left\| \mathcal{X} \right\|_F$

**Основной цикл**:

Пока $r \geq \epsilon$ выполняем:

1. Для каждого измерения $n = 1$ до $3$:
   - Вычисляем матрицы развёрток $\mathcal{X}_{(n)}$ по измерению $n$.
   - Находим $R_n^{(k)}$ ведущих левых сингулярных векторов $U^{(n)}$ матрицы $\mathcal{X}_{(n)}$.
   - Обновляем ранг: $R_n^{(k+1)} \leftarrow R_n^{(k)} - 1$.
2. Увеличиваем итерацию: $k \leftarrow k + 1$.
3. Обновляем ядро:

   $$
   \mathcal{G}^{(k)} \leftarrow \mathcal{X} \times_1 U^{(1)T} \times_2 U^{(2)T} \times_3 U^{(3)T}
   $$

4. Вычисляем ошибку:

   $$
   r \leftarrow \left\| \mathcal{G}^{(k)} - \mathcal{G}^{(k-1)} \right\|_F
   $$

**Возврат**:

- $\hat{\mathcal{G}} \leftarrow \mathcal{G}^{(k)}$
- $\hat{A} \leftarrow U^{(1)}$
- $\hat{B} \leftarrow U^{(2)}$
- $\hat{C} \leftarrow U^{(3)}$

### Пояснение алгоритма

1. **Инициализация**: Начинаем с нулевого приближения ядра и устанавливаем ранг для каждого измерения как минимальное из размеров тензора.
2. **Основной цикл**: Повторяем процесс, пока ошибка не станет меньше заданного порога $\epsilon$.
3. **Выбор сингулярных векторов**: Для каждого измерения выбираем ведущие левые сингулярные векторы, соответствующие наиболее значимым компонентам.
4. **Обновление ядра**: Ядро пересчитывается с использованием новых матриц мод.
5. **Оценка ошибки**: Рассчитываем разницу между текущим и предыдущим ядром для оценки сходимости.

## Применение к временным данным

В данной работе временное измерение системы, изменяющейся во времени, кодируется как третье измерение тензора $\mathcal{X}$. Это позволяет анализировать временные характеристики системы.

### Определение мод, не зависящих от времени

Моды, не зависящих от времени, определяются с помощью матриц мод и ядра, полученных из HOSVD:

$$
\mathcal{M}_{::n} = A \times \mathcal{G}_{::n} \times B
$$

где:

- $\mathcal{M}_{::n}$ — $n$-я мода системы.
- $\mathcal{G}_{::n}$ — срез ядра по третьему измерению.

### Анализ временных параметров

- Матрица $C$ содержит временные параметры каждой моды.
- Столбцы матрицы $C$ являются ортогональными, что упрощает анализ.
- Временная информация, связанная с каждой модой, может быть проанализирована путем преобразования временных параметров в частотную область (например, с помощью преобразования Фурье).

## Заключение

Тензорное модальное разложение с использованием модели Такера и HOSVD предоставляет эффективный способ разложения многомерных данных на основные компоненты. Это особенно полезно для систем, изменяющихся во времени, где временное измерение можно интегрировать в тензорную структуру и анализировать с использованием математических инструментов линейной алгебры и обработки сигналов.
