# Оптимальный Метод Размещения Датчиков

## Формулировка Задачи Оптимального Размещения Датчиков

### Введение

В данной работе рассматривается высокоразмерная система, полное измерение которой является сложной или практически невыполнимой задачей. Примером такой системы может служить высокоточная, высокоразмерная динамика жидкости. В подобных случаях возможно только размещение разреженных датчиков для получения ограниченных измерений.

**Размещение датчиков** относится к выбору точек отбора проб или узлов сетки, содержащих целевые значения. Мотивация поиска **оптимального разреженного размещения датчиков** в динамических системах заключается в том, чтобы точно восстановить глобальную информацию о системе, используя ограниченную локальную информацию измерений в сочетании с детерминированными физическими знаниями.

### Математическая Формулировка

**Проблема оптимального размещения датчиков (Optimal Sensor Placement, OSP)** определяется следующим образом:

\[
\mathbf{Y} = \mathbf{P} \cdot \mathbf{X} \tag{13}
\]

- \(\mathbf{P} \in \mathbb{R}^{I \times J}\) — оператор выбора датчиков, также известный как матрица перестановок в методе тензорного QR-разложения.
- \(\mathbf{X} \in \mathbb{R}^{I \times J}\) — матрица целевого поля, которое необходимо восстановить.
- \(\mathbf{Y} \in \mathbb{R}^{I \times J}\) — матрица разреженных измерений.

**Примечание**: Элемент со значением 1 в матрице \(\mathbf{P}\) обозначает размещение датчика в указанном месте, тогда как остальные элементы матрицы \(\mathbf{P}\) равны нулю, указывая на отсутствие датчика в этих местах.

### Обоснование Подхода

Манохар и соавторы [46] показали, что динамические характеристики многих физических систем могут быть описаны с помощью разреженных низкоразмерных аттракторов. На основе этого предположения задача восстановления поля может быть смоделирована следующим образом:

\[
\mathbf{X} = \mathcal{A} \times_{(3)} \mathbf{x} \tag{14}
\]

- \(\mathcal{A} \in \mathbb{R}^{I \times J \times W}\) — тензор словаря, содержащий \(W\) сложенных мод.
- \(\mathbf{x} \in \mathbb{R}^{W}\) — вектор весов мод.

**Пояснение**:

- Моды в \(\mathcal{A}\) получаются путем применения тензорного модального разложения (TBMD) к заданной физической системе при \(D\) различных параметрах системы.
- Таким образом, \(\mathcal{A} = [\mathcal{M}_1; \mathcal{M}_2; \dots; \mathcal{M}_D]_{(3)}\), где \(\mathcal{M}_d\) — мода, соответствующая \(d\)-му набору параметров системы.

### Моделирование Задачи Восстановления Поля

Задача восстановления поля с разреженными измерениями может быть представлена как:

\[
\mathbf{Y} = \mathbf{P} \cdot (\mathcal{A} \times_{(3)} \mathbf{x}) = (\mathbf{P} \times_{3} \mathcal{A}) \times_{(3)} \mathbf{x} \tag{15}
\]

- Здесь \(\mathbf{P} \times_{3} \mathcal{A}\) означает произведение матрицы \(\mathbf{P}\) на тензор \(\mathcal{A}\) по третьему измерению.

### Решение Задачи Восстановления

Значения \(\mathbf{X}\) в не измеренных местах могут быть восстановлены путем решения уравнения (15) с использованием псевдообратной матрицы \((\cdot)^{\dagger}\):

\[
\hat{\mathbf{X}} = \mathcal{A} \odot (\mathbf{P} \times_{3} \mathcal{A})^{\dagger} \times_{(3)} \mathbf{Y} \tag{16}
\]

- \(\hat{\mathbf{X}}\) — восстановленное поле.
- \(\odot\) — оператор элементного произведения (в данном контексте, возможно, символическая запись, указывающая на комбинацию).

**Примечание**: Псевдообратная матрица используется для нахождения наилучшего приближения решения переопределенной или недоопределенной системы линейных уравнений.

### Формулировка Задачи Оптимизации

Задача оптимального размещения датчиков заключается в оптимизации выбора датчиков \(\mathbf{P}\) для минимизации обобщенной ковариационной матрицы \(\Sigma\) ошибки оценки \(\mathbf{x} - \hat{\mathbf{x}}\):

\[
\det(\Sigma) = \prod_i \lambda_i \\
\Sigma = \mathrm{Var}(\mathbf{x} - \hat{\mathbf{x}}) = \mathbf{F}^{-1} \tag{17}
\]

- \(\lambda_i\) — собственные значения ковариационной матрицы \(\Sigma\).
- \(\mathbf{F}\) — матрица информации Фишера, определяемая как:

\[
\mathbf{F} = \sum_{k=1}^{K} \left( (\mathbf{P} \times_{3} \mathcal{A})_{ijk} \cdot (\mathbf{P} \times_{3} \mathcal{A})_{kij}^T \right)
\]

- \(\mathrm{Var}(\cdot)\) — оператор ковариации.

**Пояснение**:

- Матрица информации Фишера \(\mathbf{F}\) характеризует количество информации, которую наблюдения несут о неизвестных параметрах, наилучшим образом описывая их вариации.
- Обобщенная ковариационная матрица \(\Sigma\) ошибки оценки является обратной матрице информации Фишера \(\mathbf{F}\).

### Критерий Оптимального Выбора Датчиков

Критерий выбора датчиков можно выразить как задачу максимизации детерминанта матрицы информации Фишера:

\[
\mathbf{P}^* = \arg\max_{\|\mathbf{P}\|_0 = N} \log \det(\mathbf{F}) \tag{18}
\]

- \(\mathbf{P}^*\) — оптимальное размещение датчиков.
- \(\|\mathbf{P}\|_0 = N\) — ограничение на количество датчиков (число ненулевых элементов в \(\mathbf{P}\) равно \(N\)).

**Пояснение**:

- Цель состоит в том, чтобы максимизировать информацию, получаемую от датчиков, что эквивалентно минимизации неопределенности в оценке параметров системы.
- Максимизация \(\log \det(\mathbf{F})\) приводит к наибольшему уменьшению дисперсии оценки \(\mathbf{x}\).

### Итоговая Формулировка

- **Задача OSP**: Найти такое размещение \(N\) датчиков, которое максимизирует информацию о системе, получаемую через измерения, и обеспечивает наилучшее восстановление глобального поля \(\mathbf{X}\).
- Это достигается путем решения задачи оптимизации (18) с учетом ограничений на количество доступных датчиков.

### Заключение

Задача оптимального размещения датчиков формулируется как задача оптимизации, направленная на максимизацию информации, получаемой от ограниченного числа датчиков. Это позволяет обеспечить точное восстановление глобальной информации о высокоразмерной динамической системе на основе разреженных измерений и известных физических свойств системы.

**Основные моменты**:

- Использование тензорного разложения для моделирования системы и формирования тензора словаря \(\mathcal{A}\).
- Формулировка задачи восстановления поля с разреженными измерениями.
- Определение матрицы информации Фишера \(\mathbf{F}\) и ковариационной матрицы \(\Sigma\) ошибки оценки.
- Критерий оптимального выбора датчиков через максимизацию \(\log \det(\mathbf{F})\) при ограничении на количество датчиков.

**Практическое значение**:

- Данный подход позволяет эффективно размещать датчики в системах, где полное измерение невозможно из-за ограничений ресурсов или технических возможностей.
- Оптимизация размещения датчиков повышает точность восстановления системы и эффективность использования доступных измерительных средств.

---

**Ссылки**:

[46] Манохар и др. «Оптимальное разреженное измерение для нелинейной динамики с использованием глубокого обучения», 2018.

**Примечание**: В оригинальном тексте есть некоторые символические обозначения и операторы (например, \(\odot\)), которые могут требовать дополнительного пояснения или проверки в контексте конкретной работы.


## Дополнительные Определения и Пояснения

В этой главе используются несколько важных математических понятий и методов, которые являются ключевыми для понимания оптимального размещения датчиков и восстановления полей в высокоразмерных динамических системах. Ниже представлены подробные объяснения следующих терминов:

- **QR-разложение**
- **Матрица информации Фишера**
- **Тензорное QR-разложение**
- **Оператор выбора датчиков**
- **Псевдообратная матрица**
- **Матрица информации Фишера в контексте размещения датчиков**

### QR-разложение

**QR-разложение** — это факторизация матрицы, при которой заданная матрица \( \mathbf{A} \) разлагается на произведение ортогональной матрицы \( \mathbf{Q} \) и верхнетреугольной матрицы \( \mathbf{R} \):

\[
\mathbf{A} = \mathbf{Q} \mathbf{R}
\]

- **\( \mathbf{Q} \)** — ортогональная матрица (\( \mathbf{Q}^T \mathbf{Q} = \mathbf{I} \)), где \( \mathbf{I} \) — единичная матрица.
- **\( \mathbf{R} \)** — верхнетреугольная матрица.

**Применение**:

- QR-разложение используется для решения систем линейных уравнений, вычисления собственных значений и в различных численных методах.
- В контексте оптимального размещения датчиков, QR-разложение может использоваться для выбора наиболее информативных измерений или датчиков посредством **тензорного QR-разложения**.

### Тензорное QR-разложение

**Тензорное QR-разложение** — это расширение QR-разложения на тензоры (многомерные массивы данных). Оно позволяет разложить тензор на ортогональные компоненты, аналогично тому, как это делается для матриц.

- **Матрица перестановок** в тензорном QR-разложении (обозначенная как \( \mathbf{P} \)) используется для перестановки элементов тензора или выбора определенных измерений.
- В контексте OSP, тензорное QR-разложение может помочь в выборе оптимальных мест для размещения датчиков путем анализа структуры тензора данных.

### Матрица Информации Фишера

**Матрица информации Фишера (\( \mathbf{F} \))** — это матрица, которая количественно характеризует количество информации, которое наблюдаемые данные несут о неизвестных параметрах модели.

- **Определение**:

\[
\mathbf{F}_{ij} = -\mathbb{E}\left[ \frac{\partial^2 \ln L(\theta)}{\partial \theta_i \partial \theta_j} \right]
\]

где:

- \( L(\theta) \) — функция правдоподобия данных при параметрах \( \theta \).
- \( \theta_i \), \( \theta_j \) — компоненты вектора параметров \( \theta \).
- \( \mathbb{E} \) — математическое ожидание.

**Свойства**:

- Матрица информации Фишера симметрична и положительно полуопределенная.
- Инверсия матрицы информации Фишера дает нижнюю границу на ковариационную матрицу оценок параметров (граница Крамера-Рао).

**Применение в OSP**:

- В задаче оптимального размещения датчиков матрица информации Фишера используется для оценки того, насколько хорошо можно оценить параметры системы с учетом выбранных мест размещения датчиков.
- Цель — максимизировать определитель матрицы информации Фишера (\( \det(\mathbf{F}) \)), что эквивалентно минимизации неопределенности в оценке параметров.

### Оператор Выбора Датчиков

**Оператор выбора датчиков (\( \mathbf{P} \))** — это матрица, которая определяет, какие измерения или позиции включаются в набор данных с датчиков.

- **Структура**:

  - Матрица \( \mathbf{P} \) состоит из нулей и единиц.
  - Элемент \( P_{ij} = 1 \) означает, что датчик установлен в позиции \( (i, j) \).
  - Элемент \( P_{ij} = 0 \) означает отсутствие датчика в этой позиции.

- **Функция**:

  - Используется для выборки подмножества данных из полного набора данных.
  - В математических выражениях оператор выбора датчиков применяется к данным для моделирования процесса сбора разреженных измерений.

### Псевдообратная Матрица

**Псевдообратная матрица (\( \mathbf{A}^{\dagger} \))** — это обобщение обратной матрицы для случаев, когда матрица \( \mathbf{A} \) не является квадратной или невырожденной.

- **Определение**:

  - Псевдообратная матрица вычисляется с использованием сингулярного разложения (SVD) матрицы.
  - Для матрицы \( \mathbf{A} \in \mathbb{R}^{m \times n} \) псевдообратная определяется как:

\[
\mathbf{A}^{\dagger} = \mathbf{V} \mathbf{\Sigma}^{\dagger} \mathbf{U}^T
\]

где:

- \( \mathbf{A} = \mathbf{U} \mathbf{\Sigma} \mathbf{V}^T \) — SVD матрицы \( \mathbf{A} \).
- \( \mathbf{\Sigma}^{\dagger} \) — псевдообратная диагональной матрицы сингулярных значений, где каждый ненулевой элемент заменяется на обратный.

- **Применение**:

  - Решение переопределенных или недоопределенных систем линейных уравнений.
  - Восстановление данных из разреженных измерений.

- **В контексте OSP**:

  - Используется для решения уравнения (15) и восстановления полного поля \( \mathbf{X} \) из разреженных измерений \( \mathbf{Y} \).

### Матрица Информации Фишера в Контексте Размещения Датчиков

В задаче оптимального размещения датчиков матрица информации Фишера \( \mathbf{F} \) принимает особую форму, учитывающую структуру системы и расположение датчиков.

- **Формула**:

\[
\mathbf{F} = (\mathbf{P} \times_{3} \mathcal{A})^T (\mathbf{P} \times_{3} \mathcal{A})
\]

- **Объяснение**:

  - \( \mathbf{P} \times_{3} \mathcal{A} \) — произведение оператора выбора датчиков на тензор словаря по третьему измерению, фактически выбирая те части тензора \( \mathcal{A} \), которые соответствуют расположению датчиков.
  - Матрица \( \mathbf{F} \) отражает, насколько выбранные датчики информативны для оценки параметров системы.

- **Критерий Оптимизации**:

  - Максимизация \( \log \det(\mathbf{F}) \) означает, что мы стремимся выбрать такие позиции для датчиков, которые дают наибольшую возможную информацию о системе.
  - Это приводит к наилучшему восстановлению параметров и минимизации неопределенности.

### Тензор Словаря и Низкоразмерные Аттракторы

**Тензор словаря (\( \mathcal{A} \))** — это тензор, содержащий базовые функции или моды, используемые для представления сложной системы в более компактной форме.

- **Формирование**:

  - Получается путем объединения мод, полученных из тензорного модального разложения системы при различных параметрах.
  - Обозначается как \( \mathcal{A} = [\mathcal{M}_1; \mathcal{M}_2; \dots; \mathcal{M}_D]_{(3)} \).

- **Применение**:

  - Используется для построения модели системы, в которой поле \( \mathbf{X} \) представляется как линейная комбинация этих мод с весами \( \mathbf{x} \).

**Низкоразмерные Аттракторы** — это математические объекты, которые описывают динамику системы в пространстве состояний, имея при этом гораздо меньшую размерность по сравнению с исходным пространством.

- **Значение**:

  - Многие физические системы имеют поведение, которое эффективно описывается в низкоразмерном подпространстве.
  - Это позволяет использовать разреженные модели для анализа и восстановления систем, что особенно полезно при ограниченном числе измерений.

### Оператор Произведения Тензора на Матрицу по Определенному Измерению (\( \times_{(n)} \))

**Оператор \( \times_{(n)} \)** — это операция умножения тензора на матрицу по заданному измерению \( n \).

- **Определение**:

  - Пусть \( \mathcal{A} \in \mathbb{R}^{I_1 \times I_2 \times \dots \times I_N} \) — тензор порядка \( N \), и \( \mathbf{M} \in \mathbb{R}^{J \times I_n} \) — матрица. Тогда произведение \( \mathcal{A} \times_{(n)} \mathbf{M} \) есть тензор размерности \( I_1 \times \dots \times I_{n-1} \times J \times I_{n+1} \times \dots \times I_N \).

- **Применение**:

  - Используется для преобразования тензора, изменяя его размерность по выбранному измерению.
  - В контексте модели системы, это позволяет комбинировать тензор словаря с весовыми коэффициентами для восстановления поля.

### Символы и Обозначения

- **\( \mathcal{X} \)**, **\( \mathbf{X} \)** — исходный тензор или матрица поля, которое необходимо восстановить.
- **\( \mathbf{Y} \)** — матрица разреженных измерений, полученных с датчиков.
- **\( \mathbf{P} \)** — оператор выбора датчиков (матрица перестановок).
- **\( \mathcal{A} \)** — тензор словаря, содержащий моды системы.
- **\( \mathbf{x} \)** — вектор весов, соответствующих модам в \( \mathcal{A} \).
- **\( \hat{\mathbf{X}} \)** — восстановленное поле, полученное из разреженных измерений.
- **\( \dagger \)** — символ псевдообратной матрицы.
- **\( \times_{(n)} \)** — оператор произведения тензора на матрицу по \( n \)-му измерению.
- **\( \mathrm{Var}(\cdot) \)** — оператор ковариации.
- **\( \det(\cdot) \)** — определитель матрицы.
- **\( \log \det(\mathbf{F}) \)** — критерий оптимизации для выбора датчиков.

---

## Заключение

Понимание перечисленных выше понятий и методов является ключевым для глубокого понимания подхода к оптимальному размещению датчиков и восстановления полей в высокоразмерных динамических системах. Эти математические инструменты позволяют эффективно решать задачи, связанные с ограниченностью измерительных ресурсов и необходимостью точного восстановления систем на основе разреженных данных.

- **QR-разложение** и его тензорный аналог помогают в анализе и упрощении многомерных данных.
- **Матрица информации Фишера** предоставляет количественную оценку того, насколько выбранные датчики информативны для задачи оценки параметров.
- **Псевдообратная матрица** позволяет решать системы уравнений, возникающие при попытке восстановить полное поле из ограниченного набора измерений.
- **Оператор выбора датчиков** и соответствующие математические операции моделируют процесс сбора данных и позволяют формализовать задачу оптимизации размещения датчиков.

Использование этих методов и понимание их теоретических основ позволяет разрабатывать эффективные алгоритмы и решения для практических приложений в различных областях науки и техники.
